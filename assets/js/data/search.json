[ { "title": "Nextcloud en Docker", "url": "/posts/nextcloud/", "categories": "Linux", "tags": "Linux, Shell, Terminal", "date": "2024-01-15 10:00:00 +0100", "snippet": "INTRODUCCIÓNHoy vamos a ver la instalación del aplicativo de Nextcloud usando Docker en una Raspberry Pi 4, tambien veremos la instalación de Portainer para gestionar y configurar de una manera vis...", "content": "INTRODUCCIÓNHoy vamos a ver la instalación del aplicativo de Nextcloud usando Docker en una Raspberry Pi 4, tambien veremos la instalación de Portainer para gestionar y configurar de una manera visual y desde el navegador nuestros diferentes contenedores y sus opciones. Procederemos a instalar los requisitos minimos.Instalación de Portainer:Este paso no es necesario, pero despues de la experiencia que he tenido con el, me parece superinteresante y recomendable instalarlo.sudo docker pull portainer/portainer-ce:latestsudo docker run -d -p 9000:9000 --name=portainer --restart=always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer-ce:latestUna vez termina la instalación y la miniconfiguración que hemos aplicado en el segundo comando, nos dirijimos a http://[DIRECCIÓN-IP]:9000Instalación de Nextcloud:Realizamos la instalación desde el mismo repositorio de Docker.docker pull nextclouddocker run -d -p 8080:80 --name nextcloud nextclouddocker logs nextcloudInstalación de MariaDB:Probando la configuración de Portainer, realicé la instalación desde el mismo en la sección App TemplatesDESARROLLOMuy importante, ambos contenedores deben estar en la misma red, lo mas recomendable es usar una conexión puente. O usamos la conexión por defecto como he hecho yo o creamos una nueva conexión puente y asi podemos crear distintas islas de conexiones con los diferentes servicios que a su vez interactúan entre si.Al iniciar Nextcloud nos indica que por defecto usa SQL Lite y no lo recomienda para el uso de clientes, es nuestro caso, asi que vamos a configurar la bbdd en el contenedor de MariaDB.Nos conectamos a nuestra raspberry y listamos los contenedores.Usamos Docker exec para conectarnos al contenedor deseado.Realizamos la conexión a MariaDB, la contraseña es la que configuramos cuando realizamos la instalación desde Portainer.Creamos la BBDDCREATE DATABASE nextcloud;Creamos el usuarioCREATE USER ‘nextcloud’@’%’ IDENTIFIED BY ‘clavequequeramosponer;(Importante el usuario con %)Damos permisos al usuario en la BBDDGRANT ALL PRIVILEGES ON nextcloud.* TO nextcloud@’%’;Aplicamos los cambiosFLUSH PRIVILEGES;Nos dirijimos a la web de nuestro Nextcloud y rellenamos los datos.Le damos a Instalar y tardará unos minutos, podéis ir a tomar un café perfectamente :DY cuando termina el proceso de instalación, ya tenemos la nube lista.CONCLUSIÓNPodriamos haber montado un stack para Nextcloud pero me ha parecido desaprovechar una instancia de BBDD que podria usar para algun que otro proyecto, por eso la he realizado en contenedores distintos." }, { "title": "Comandos Linux", "url": "/posts/comandos/", "categories": "Linux", "tags": "Linux, Shell, Terminal", "date": "2023-07-25 11:00:00 +0200", "snippet": "INTRODUCCIÓNOs traigo una recopilación de comandos Linux para diferentes usos, desde Redes a gestión de discos pasando por adminstración de servicios. Espero que sea de utilidad, estaré actualizand...", "content": "INTRODUCCIÓNOs traigo una recopilación de comandos Linux para diferentes usos, desde Redes a gestión de discos pasando por adminstración de servicios. Espero que sea de utilidad, estaré actualizando esta entrada.DESARROLLOOperaciones de Archivos: Comando Descripción ls Lista todos los archivos y directorios en el directorio de trabajo actual ls -R Lista los archivos en subdirectorios también ls -a Muestra archivos ocultos ls -al Lista archivos y directorios con información detallada como permisos, tamaño, propietario, etc cd nombredeldirectorio Cambia al directorio especificado cd .. Retrocede un nivel pwd Muestra el directorio de trabajo actual cat &gt; nombredelarchivo Crea un nuevo archivo cat archivo1 archivo2 &gt; archivo3 Une dos archivos (archivo1 y archivo2) y guarda el resultado en un nuevo archivo (archivo3) touch nombredelarchivo Crea o modifica un archivo rm nombredelarchivo Elimina un archivo cp origen destino Copia archivos desde la ruta de origen a la ruta de destino mv origen destino Mueve archivos desde la ruta de origen a la ruta de destino find / -name nombredelarchivo Encuentra un archivo o directorio por su nombre, comenzando desde la raíz file nombredelarchivo Determina el tipo de archivo less nombredelarchivo Muestra el contenido del archivo página por página head nombredelarchivo Muestra las primeras diez líneas de un archivo tail nombredelarchivo Muestra las últimas diez líneas de un archivo lsof Muestra qué archivos están abiertos por qué proceso du -h –max-depth=1 Muestra el tamaño de cada directorio. Usa –max-depth=1 para limitar la salida al directorio actual y sus hijos inmediatos fdisk Comando de manipulación de particiones de disco Operaciones con paquetes: Comando Descripción apt update (Debian) Actualiza la base de datos de los paquetes con los repositorios apt upgrade (Debian) Actualiza los paquetes usando la ultima versión de los repositorios apt autoremove (Debian) Elimina los paquetes obsoletos despues de un upgrade apt install ‘paquete’ (Debian) Instala un paquete apt-cache ‘paquete’ (Debian) Busca un paquete apt remove ‘paquete’ (Debian) Desinstala un paquete dpkg -i ‘paquete descargado’ (Debian) Instala un paquete descargado previamente dpkg –configure -a (Debian) Configura los paquetes pendientes yum update (RedHat) Actualiza la base de datos de los paquetes con los repositorios yum upgrade (RedHat) Actualiza los paquetes usando la ultima versión de los repositorios yum install ‘paquete’ (RedHat) Instala un paquete yum remove ‘paquete’ (RedHat) Desinstala un paquete rpm -qa Lista los paquetes instalados en el sistema, recomendable usar con ‘grep’ package-cleanup –oldkernels –count=2 (RedHat) Elimina los kernels antiguos manteniendo los dos mas actuales Operaciones de Procesos: Comando Descripción ps Muestra los procesos activos en el momento top Muestra todos los procesos en ejecución kill pid Finaliza el proceso con el PID (identificador del proceso) dado pkill nombre Finaliza el proceso con el nombre especificado bg Reactiva trabajos suspendidos sin llevarlos al primer plano fg Lleva el trabajo más reciente al primer plano fg n Lleva el trabajo n al primer plano renice +n [pid] Cambia la prioridad de un proceso en ejecución &amp;&gt;nombredelarchivo Redirige tanto la salida estándar como la de error al archivo especificado 1&gt; nombredelarchivo Redirige la salida estándar al archivo especificado 2&gt; nombredelarchivo Redirige la salida de error al archivo especificado Permisos de Archivos: Comando Descripción chmod octal nombredelarchivo Cambia los permisos del archivo a octal, que puede estar entre 0 (sin permisos) y 7 (permisos completos) chown nombredepropietario nombredelarchivo Cambia el propietario del archivo chown nombredepropietario:nombredelgrupo nombredelarchivo Cambia el propietario y el grupo del archivo chgrp nombredelgrupo nombredelarchivo Cambia el grupo propietario del archivo Redes: Comando Descripción ping host Realiza un ping a un host y muestra los resultados whois dominio Obtiene información whois para un dominio dig dominio Obtiene información DNS para un dominio netstat -pnltu Muestra información relacionada con la red, como conexiones de red, tablas de enrutamiento, estadísticas de interfaz, etc ifconfig Muestra las direcciones IP de todas las interfaces de red ssh usuario@host Inicio de sesión remoto en el host como usuario scp Transfiere archivos entre hosts a través de ssh wget url Descarga archivos desde la web curl url Envía una solicitud a una URL y devuelve la respuesta traceroute dominio mtr combina la funcionalidad de los programas traceroute y ping en una sola herramienta de diagnóstico de red mtr dominio Cambia el propietario y el grupo del archivo ss Otra utilidad para investigar sockets. Es una alternativa más moderna a netstat nmap Herramienta de exploración de redes y escaneo de seguridad Compresión y Archivos: Comando Descripción tar cf archivo.tar archivos Crea un archivo tar llamado archivo.tar que contiene los archivos especificados tar xf archivo.tar Extrae los archivos de archivo.tar gzip archivo Comprime el archivo y lo renombra a archivo.gz gzip -d archivo.gz Descomprime archivo.gz y lo restaura al archivo original zip -r archivo.zip archivos Crea un archivo zip llamado archivo.zip que contiene los archivos especificados unzip archivo.zip Extrae el contenido de un archivo zip tar -cvf archiv.tar directorio/ Crea un archivo tar tar -xvf archiv.tar Extrae un archivo tar tar -jcvf archiv.tar.bz2 directorio/ Crea un archivo bz2 comprimido tar -jxvf archiv.tar.bz2 Extrae un archivo bz2 comprimido Procesamiento de Texto: Comando Descripción grep patrón archivos Busca un patrón en los archivos grep -r patrón directorio Busca de forma recursiva un patrón en un directorio comando | grep patrón Envia la salida del comando a grep para buscar echo ‘texto’ Imprime texto sed ‘s/cadena1/cadena2/g’ nombredelarchivo Reemplaza cadena1 con cadena2 en el archivo diff archivo1 archivo2 Compara dos archivos y muestra las diferencias wc nombredelarchivo Cuenta líneas, palabras y caracteres en un archivo awk Un lenguaje de programación versátil para trabajar con archivos Uso del Disco: Comando Descripción df Muestra el uso del disco du Muestra el uso del espacio en directorios free Muestra el uso de memoria y swap whereis aplicación Muestra las posibles ubicaciones de una aplicación dd if=/dev/zero of=/tmp/salida.img bs=8k count=256k Crea un archivo de un tamaño determinado para probar la velocidad del disco. No usar con Veritas hdparm -Tt Mide la velocidad de lectura de tu disco duro Veritas: Comando Descripción hastatus -sum Ver estado de cluster hagrp -online nombrecluster -sys nombreservidor Levantar cluster en servidor indicado hagrp -ofline nombrecluster -sys nombreservidor Desactivar cluster en servidor indicado hagrp -switch nombrecluster -to nombreservidor2 Cambiar cluster de nodo hares -state nombreaplicacioncluster Comprueba el estado de la aplicación Información del Sistema: Comando Descripción date Muestra la fecha y hora actual cal Muestra el calendario del mes actual uptime Muestra el tiempo de actividad actual w Muestra quién está en línea whoami Muestra el nombre del usuario actual uname -a Muestra información del kernel df -h Uso del disco en formato legible para humanos du -sh Uso del disco del directorio actual en formato legible para humanos free -m Muestra la memoria libre y utilizada en MB SELinux: Comando Descripción ausearch -m AVC,USER_AC,SELINUX_ERR,USER_SELINUX_ERR -ts recent Muestra las rutas bloqueadas por SELinux matchpathcon -V rutadelarchivodelog Muestra las etiquetas actuales y las que debe tener chcon -Rv –type=nombreetiqueta rutadelarchivo Realiza un reetiquetado temporal semanage fcontext -a -t nombreetiqueta “rutadelarchivo” Realiza un reetiquetado permanente añadiendo una etiqueta semanage fcontext -m -t nombreetiqueta “rutadelarchivo” Realiza un reetiquetado permanente modificando una etiqueta rescorecon -v rutadelarchivo Ejecuta los cambios realizados por chcon o semanage ls -Z Muestra las etiquetas de una carpeta o archivo Otros (principalmente utilizados en scripts): Comando Descripción comando1 ; comando2 Ejecuta comando1 y luego comando2 comando1 &amp;&amp; comando2 Ejecuta comando2 solo si comando1 es exitoso comando1 || comando2 Ejecuta comando2 solo si comando1 no es exitoso comando &amp; Ejecuta el comando en segundo plano Variables de Entorno: Comando Descripción env Muestra todas las variables de entorno echo $VARIABLE Muestra el valor de una variable de entorno export VARIABLE=valor Establece el valor de una variable de entorno alias nuevo_comando=’viejo_comando opciones’ Ejecuta el comando en segundo plano echo $PATH Imprime la variable de entorno PATH export PATH=$PATH:/nueva/ruta Agrega /nueva/ruta a la variable de entorno PATH Programación de Tareas (Cron Jobs): Comando Descripción crontab -l Lista todas tus tareas cron crontab -e Edita tus tareas cron crontab -r Elimina todas tus tareas cron crontab -v Muestra la última vez que editaste tus tareas cron crontab archivo Instala una tarea cron desde un archivo @reboot comando Programa una tarea para que se ejecute al inicio Scripting de Shell: Comando Descripción #!/bin/bash Línea shebang para especificar el intérprete de scripts $0, $1, …, $9, ${10}, ${11} Argumentos del script if [condición]; then … fi Estructura de la declaración if en scripts de bash for i in {1..10}; do … done Bucle for en scripts de bash while [condición]; do … done Bucle while en scripts de bash función nombre() {…} Define una función Monitoreo y Rendimiento del Sistema: Comando Descripción iostat Informa estadísticas de la Unidad Central de Procesamiento (CPU) y estadísticas de entrada/salida para dispositivos, particiones y sistemas de archivos de red vmstat Argumentos del script htop Estructura de la declaración if en scripts de bash Búsqueda y Encontrar: Comando Descripción locate nombredelarchivo Encuentra un archivo por su nombre. La base de datos se actualiza con el comando updatedb whereis nombredeprograma Localiza los archivos binarios, de origen y de página de manual para un comando which nombredelcomando Muestra la ruta completa de los comandos (shell) Otros: Comando Descripción yes &gt; /dev/null &amp; Usa este comando para llevar un sistema al límite ”:(){ :|:&amp; };::” Una bomba: úsala con cuidado. No ejecutes este comando en un sistema de producción RECOMENDACIÓNRecuerda que siempre puedes usar el comando man (por ejemplo, man ls) para obtener más información sobre cada comando." }, { "title": "NfTables", "url": "/posts/nftables/", "categories": "Linux", "tags": "Linux, Aplicaciones, Firewall", "date": "2023-04-28 11:00:00 +0200", "snippet": "INTRODUCCIÓNHoy vamos a hablar un poquito de nftables, tambien llamado el sucesor de iptables. RHEL 8 aconseja su uso para entornos complejos y críticos.Documentación oficial RHEL8Nftables se basa ...", "content": "INTRODUCCIÓNHoy vamos a hablar un poquito de nftables, tambien llamado el sucesor de iptables. RHEL 8 aconseja su uso para entornos complejos y críticos.Documentación oficial RHEL8Nftables se basa en tablas 😉 y tiene un archivo de configuración que podriamos llamarlo la piedra angular del servicio ubicado en /etc/sysconfig y llamado nftables.confComo bien indica la documentación, se aconseja el uso para entornos complejos asi que debemos gestionar las tablas de manera individual, usando el archivo mencionado antes para solamente guardar la configuración.DESARROLLOPara comenzar a usar nftables tenemos que crear la estructura de las tablas en cuestion.Vamos a crear una tabla llamada mitablanft add table inet mitablaSeguidamente vamos a crear las 3 cadenas (Input, Output y Forward)nft add chain inet mitabla input '{type filter hook input priority filter;}'nft add chain inet mitabla output '{type filter hook output priority filter;}'nft add chain inet mitabla forward '{type filter hook forward priority filter;}'Esto es la estructura base, ahora es momento de ir añadiendo las diferentes reglas.Un ejemplo de Inputnft add rule inet mitabla input ip saddr \"ip_remota\" ip daddr \"ip_local\" tcp/udp dport \"puerto\" acceptUn ejemplo de Outputnft add rule inet mitabla output ip saddr \"ip_local\" ip daddr \"ip_remota\" tcp/udp dport \"puerto\" acceptUn detalle a tener en cuenta, es que podemos añadir reglas con el nombre del equipo en vez de usar la ip, pero nftables al final cambiará esa linea y usará la ip.Una vez tengamos añadidas todas las reglas de la tabla MITABLA procedemos primero a guardar esa tabla en un archivo y luego a actualizar el archivo de configuracion.nft list table inet mitabla &gt; /etc/nftables/nftables.d/00-mitablanft list ruleset &gt; /etc/sysconfig/nftables.confRECOMENDACIÓNSi en un futuro necesitamos editar o añadir algún parámetro en esta tabla, el procedimiento seria el siguiente: Editamos el archivo vi /etc/nftables/nftables.d/00-mitabla Vaciamos la tabla MITABLA nft flush table inet mitabla Importamos la nueva nft -f /etc/nftables/nftables.d/00-mitabla Guardamos en el archivo de configuración nft list ruleset &gt; /etc/sysconfig/nftables.conf Para comprobar que los datos estan correctos, reiniciamos el servicio systemctl restart nftables y comprobamos que los cambios están persistentes nft list table inet mitabla De esta manera, tenemos organizadas las reglas por tablas en la carpeta del ejemplo /etc/nftables/nftables.d y podemos ir importando lo que vayamos necesitando. Espero que haya sido de utilidad. 😉" }, { "title": "Phanthom process killer en Termux", "url": "/posts/termux/", "categories": "Linux, Android", "tags": "Linux, Aplicaciones, Pentesting", "date": "2023-03-08 10:00:00 +0100", "snippet": "Hoy vamos a ver una entrada sobre Android. Concretamente un problema de gestión de procesos en Android 12/13.INTRODUCCIÓNSoy usuario de Termux en mi móvil y Tablet y además uso NetHunter Rootless, ...", "content": "Hoy vamos a ver una entrada sobre Android. Concretamente un problema de gestión de procesos en Android 12/13.INTRODUCCIÓNSoy usuario de Termux en mi móvil y Tablet y además uso NetHunter Rootless, bueno pues desde que está con nosotros Android 12 tenemos un inconveniente llamado “Phantom Process Killer”. Básicamente el sistema operativo matará cualquier proceso mayor de 32 (es el limite de todas las aplicaciones combinadas).Debido a esto, cuando iniciamos KEX para obtener una interface gráfica de NetHunter obtenemos a los pocos segundos (el tiempo que tarda el sistema en matar los procesos) el siguiente error en Termux.Process completed (signal 9) – press EnterSOLUCIÓNNecesitamos: Habilitar las Opciones del desarrollador en el terminal y habilitar dentro la Depuración por USB. Descargar ADB en un pc.Una vez conectemos el terminal por usb, aceptamos el mensaje y escribimosadb devicesPara comprobar que nos reconoce el terminal.A continuación, vamos a ejecutar los siguientes comandos en orden.adb shell \"/system/bin/device_config set_sync_disabled_for_tests persistent”adb shell \"/system/bin/device_config put activity_manager max_phantom_processes 2147483647”adb shell settings put global settings_enable_monitor_phantom_procs falseCOMPROBACIÓNPara comprobar que todo esta correcto, ejecutamos los siguientes comandos:adb shell \"/system/bin/dumpsys activity settings | grep max_phantom_processes”Nos devolverá “max_phantom_processes=2147483647”adb shell \"/system/bin/device_config get activity_manager max_phantom_processes”Nos devolverá 2147483647Ya podemos disfrutar de KEX sin problemas. 😉" }, { "title": "Analizando un dominio", "url": "/posts/dominio/", "categories": "Linux", "tags": "Linux, Aplicaciones, Pentesting", "date": "2023-01-30 10:00:00 +0100", "snippet": "Hoy vamos a analizar la información que nos da un dominio de internet, usaremos las aplicaciones host, dig y whois.HOSTLa sintáxis de host es:host (modificadores) dominio\"Realizamos una prueba con ...", "content": "Hoy vamos a analizar la información que nos da un dominio de internet, usaremos las aplicaciones host, dig y whois.HOSTLa sintáxis de host es:host (modificadores) dominio\"Realizamos una prueba con una web, por ejemplo “marca.com”Además, podemos realizar DNS inverso 😉A continuación os dejo el enlace a toda su información.Host manualDIGLa sintáxis de dig es un poco más compleja en la teoria:dig (modificadores)@servidor.dns dominio tipo_de_registo Al usar el mismo comando vemos que nos da algunos datos más que host.Dig es bastante extenso, os dejo acceso a toda su información para quien quiera seguir probando cosas.Dig manualWHOISWhois es uno de las aplicaciones por excelencia para averiguar informacion sobre un dominio, su sintáxis es sencilla:whois dominioEn la siguiente captura podemos ver una parte de lo que ha conseguido.A continuación os dejo el enlace a toda su información.Whois manualEspero que haya sido de vuestro agrado. 😉" }, { "title": "Crear red personalizada en Hyper-V", "url": "/posts/nat_hyperv/", "categories": "Windows", "tags": "Powershell, Hyper-V", "date": "2023-01-01 10:00:00 +0100", "snippet": "Comenzamos el año con una entrada, la cual en mi experiencia, es muy importante. Desde hace unos años uso Hyper-V como gestor de máquinas virtuales en Windows y uno de los problemas que tenian vers...", "content": "Comenzamos el año con una entrada, la cual en mi experiencia, es muy importante. Desde hace unos años uso Hyper-V como gestor de máquinas virtuales en Windows y uno de los problemas que tenian versiones anteriores era la gestion de la red. Con este pequeño truco no volveremos a tener problemas en la conexión a internet de nuesta virtual aunque el host cambie de cable a wifi (muy común en Hyper-V que ocurra esto).RequisitosTenemos que identificar un rango de IPs que no vaya a tener problemas con otras redes. Por ejemplo 192.168.200.0/24.Abrimos Powershell como administrador.ProcedimientoCrearemos un switch interno llamado MiSwitchInterno.New-VMSwitch -SwitchName \"MiSwitchInterno\" -SwitchType InternalVamos a listar los adaptadores y debemos apuntar la numeración del ifIndex de nuestro switch.Get-NetAdapterUna vez identificado, procedemos a configurar una IP fija en el switch (por ejemplo 74).New-NetIPAddress -IPAddress 192.168.200.2 -PrefixLength 24 -InterfaceIndex 74Por último creamos la NAT para darle salida a internet a nuestro switch.New-NetNat -Name MiNatSwitch -InternalIPInterfaceAddressPrefix 192.168.200.0/24De esta manera, podemos crear una subred donde al asignar IPs fijas a las máquinas virtuales ya no tendremos problemas de conectividad.Por ejemplo, con los datos suministrados, al asignar este switch interno no obtendria internet, debemos asignarle una IP fija dentro del rango 192.168.200.0/24 y obligatoriamente poner de puerta de enlace 192.168.200.2. De DNS puede ponerse los de Google o Cloudflare.Al usar todas el mismo rango, podemos incluso crear clusters o realizar pruebas entre ellas sin problema.El mundo de las redes es muy bonito pero a la vez complejo, espero haberme explicado correctamente 😉Otros comandos de interés pueden ser:Ver los NATsGet-NetNatEliminar un NATRemove-NetNat -Name MiNatSwitch" }, { "title": "Instalación y configuración de Bitbucket Server en Ubuntu", "url": "/posts/bitbucket/", "categories": "Linux", "tags": "Linux, Aplicaciones", "date": "2022-12-10 10:00:00 +0100", "snippet": "Tal y como vimos en el post anterior con la instalación de Subversion, hoy vamos a ver como instalar Bitbucket server en nuestro servidor Ubuntu. Para extrapolarlo a otro linux tenemos que tener en...", "content": "Tal y como vimos en el post anterior con la instalación de Subversion, hoy vamos a ver como instalar Bitbucket server en nuestro servidor Ubuntu. Para extrapolarlo a otro linux tenemos que tener en cuenta las dependencias ya que en RHEL o CentOS las versiones de Git en los repositorios son antiguas y hay que instalarlo compilando desde la fuente.Descarga.Podemos hacer la descarga de tres maneras distintas. Ejecutable .bin y los comprimidos tar.gz y zip. En este caso vamos a hacerlo con .bin. Lo descargamos de la siguiente URL https://www.atlassian.com/es/software/bitbucket/download-archivesRequisitos.Si hacemos la instalacion con el .bin solamente necesitamos una version actualizada de Git. En Ubuntu no hay problema asi que instalamos normalmente.sudo apt install gitEn RHEL y derivados tenemos que instalar Git desde la fuente ya que los repositorios no tienen una versión actualizada del mismo.Básicamente la instalación seria algo asi:sudo yum -y remove git*sudo yum -y install epel-releasesudo yum -y groupinstall \"Development Tools\"sudo yum -y install wget perl-CPAN gettext-devel perl-devel openssl-devel zlib-devel curl-devel expat-devel getopt asciidoc xmlto docbook2X curl zlib-develsudo ln -s /usr/bin/db2x_docbook2texi /usr/bin/docbook2x-texi\t-- -- -- export VER=\"v2.38.1\"wget https://github.com/git/git/archive/${VER}.tar.gztar -xvf ${VER}.tar.gzrm -f ${VER}.tar.gzcd git-*make configuresudo ./configure --prefix=/usrsudo makesudo make installY la desinstalación en caso de necesitarlo 😉:./configuresudo make &amp;&amp; sudo make DESTDIR=/var/tmp/git installsudo find /var/tmp/git -type f -printf '/%P\\n' | sudo xargs -n 10 rm -fInstalación.Damos permisos de ejecución y ejecutamos el archivo.chmod +x atlassian-bitbucket-8.6.1-x64.bin./atlassian-bitbucket-8.6.1-x64.binEn las siguientes imágenes podemos ver las preguntas que va realizando y la respuesta.Una vez termine el proceso accedemos a la url.http://IP_Servidor:7990/setupY veremos lo siguienteSeguidamente necesitaremos la licencia de instalación. Para un server podemos solicitar una evaluación de 90 dias simplemente registrandonos en la web. Una vez hecho veremos algo así.Una vez tenemos la licencia solo nos queda crear el usuario.Iniciamos sesión y ya estamos dentro.A disfrutarlo! ;)" }, { "title": "Instalación y configuración de SVN en CentOS", "url": "/posts/svn/", "categories": "Linux", "tags": "Linux, Aplicaciones", "date": "2022-11-27 09:30:00 +0100", "snippet": "El término SVN se refiere a un software de control de versiones y existe desde hace mucho tiempo y aunque aplicaciones del tipo git (como el Github donde estas leyendo esto) o Bitbucket puedan ser ...", "content": "El término SVN se refiere a un software de control de versiones y existe desde hace mucho tiempo y aunque aplicaciones del tipo git (como el Github donde estas leyendo esto) o Bitbucket puedan ser la evolución natural, lo cierto es que SVN se sigue usando.Vamos a realizar una instalación básica en CentOS 7.Instalación.Realizamos la instalación de todos los paquetes necesarios y editamos la configuración de Apache.sudo yum install httpd subversion libapache2-svn libsvn-dev mod_dav_svn\t -----vim /etc/httpd/conf/httpd.conf -- Editar y habilitar el puerto 80Seguidamente habilitaremos los modulos necesarios en Apache.vim /etc/httpd/conf.d/subversion.conf -----# Make sure you uncomment the following if they are commented outLoadModule dav_svn_module modules/mod_dav_svn.soLoadModule authz_svn_module modules/mod_authz_svn.so# Add the following to allow a basic authentication and point Apache to where# the actual# repository resides.&lt;Location /repos&gt; DAV svn SVNPath /var/www/svn/repos AuthType Basic AuthName \"Subversion repos\" AuthUserFile /etc/svn-auth-conf Require valid-user&lt;/Location&gt;Y reiniciamos el servicio de Apache como de costumbre para aplicar los cambios.service httpd startConfiguración.Crearemos el directorio dedicado a subversión y otorgaremos los permisos necesarios.mkdir /var/www/svnchmod -R 755 /var/www/svnY ahora vamos a crear nuestro primer repositorio de pruebas.svnadmin create /var/www/svn/reposchown -R apache.apache /var/www/svn/reposVamos ha crear un usuario para que pueda acceder al repositorio.sudo htpasswd -cm /etc/svn-auth-conf usuarioReiniciamos el servicio de apache y accedemos a la url de nuestro repositorio para probarlo. Nos pedirá introducir las credenciales.http://localhost/reposSería válido tanto localhost como la ip del equipo, comprobar firewalld si da algún problema." }, { "title": "Instalación y uso de Win-Kex en Ubuntu", "url": "/posts/kex/", "categories": "Linux", "tags": "Linux, Aplicaciones, Pentesting", "date": "2022-11-01 09:30:00 +0100", "snippet": "Hoy os traigo una de las aplicaciones estrella de Kali Linux de WSL. No es otra que Kali-Win-Kex, el entorno gráfico nativo.La web del proyecto es la siguiente: Proyecto Kali-Win-KexInstalación.Com...", "content": "Hoy os traigo una de las aplicaciones estrella de Kali Linux de WSL. No es otra que Kali-Win-Kex, el entorno gráfico nativo.La web del proyecto es la siguiente: Proyecto Kali-Win-KexInstalación.Como con cualquier archivo .deb debemos descargarlo. La última versión estable podemos obtenerla desde aquí.Elegimos el archivo de nuestra arquitectura y lo descargamos.wget https://http.kali.org/pool/main/k/kali-win-kex/kali-win-kex_3.1_amd64.debInstalamossudo dpkg -i kali-win-kex_3.1_amd64.debSi nos da error, ejecutamos lo siguiente, ya que es un paquete que necesita algunas (bastantes) dependencias que por defecto, el WSL de Ubuntu no trae instaladas.sudo apt -f installAhora vamos a instalar el entorno gráfico. Kali Linux por defecto viene con XFCE4 en WSL. Pues vamos a instalar el mismo o parecido (xubuntu-desktop tambien valdría) y así aseguramos el éxito.sudo apt install xfce4Ejecución.Una vez instaladas todas las dependencias y sin más errores, ejecutamos la aplicación.kexSeguimos los pasos normales de TightVNC y escribimos las Password que nos solicita.Y si todo va bien deberia de iniciar el escritorio XFCE4. 😉Vereis algo parecido a la imagen de este post." }, { "title": "WPScan, software para analizar vulnerabilidades en Wordpress", "url": "/posts/wpscan/", "categories": "Linux", "tags": "Linux, Aplicaciones, Pentesting", "date": "2022-10-26 10:20:00 +0200", "snippet": "Siguiendo en la linea de la recomendación de aplicaciones interesantes, le ha llegado el turno a WPScan.Estamos hablando de un software gratuito que ayuda a identificar los problemas relacionados c...", "content": "Siguiendo en la linea de la recomendación de aplicaciones interesantes, le ha llegado el turno a WPScan.Estamos hablando de un software gratuito que ayuda a identificar los problemas relacionados con la seguridad en un sitio con Wordpress.Verifica entre otros: La propia instalación de Wordpress. Vulnerabilidades en Themes y Plugins. Brute Force.Teniendo en cuenta que Wordpress es el CMS mas popular con diferencia, conocer esta utilidad es un plus.Instalación.Para instalarlo, necesita unos prerequisitos que los conseguiremos con el siguiente comando.sudo apt install curl git libcurl4-openssl-dev make zlib1g-dev gawk g++ gcc libreadline6-dev libssl-dev libyaml-dev libsqlite3-dev sqlite3 autoconf libgdbm-dev libncurses5-dev automake libtool bison pkg-config ruby ruby-bundler ruby-dev -ySeguidamente instalamos usando GEM.sudo gem install wpscanEjecución.Primero actualizamos la base de datos y luego escanemos el sitio web deseado.wpscan --updatewpscan --url https://web.comOs dejo la web del proyecto en Github para que todos podamos estar pendientes de las novedades. 😉Proyecto WPScan" }, { "title": "Btop, un completo monitor de sistema para Linux", "url": "/posts/btop/", "categories": "Linux", "tags": "Linux, Aplicaciones", "date": "2022-09-30 10:00:00 +0200", "snippet": "Este post va a estrenar una nueva sección. Aplicaciones recomendadas. 😁Instalación.Para instalarlo, solamente tenemos que ejecutar lo siguiente.sudo apt install btopEjecución.Simplemente así.btopEn...", "content": "Este post va a estrenar una nueva sección. Aplicaciones recomendadas. 😁Instalación.Para instalarlo, solamente tenemos que ejecutar lo siguiente.sudo apt install btopEjecución.Simplemente así.btopEn mi Ubuntu uso Tilix como emulador de terminal, pero hay algunos reportes de que no funciona correctamente en algunos terminales." }, { "title": "Acceso a MV con red interna habilitada", "url": "/posts/Tunel_RDP/", "categories": "Windows", "tags": "Linux, Windows, Hyper-V", "date": "2022-09-12 08:10:00 +0200", "snippet": "Este post es un poco especial. Para llevarlo a cabo debéis tener un escenario parecido al siguiente.Escenario.Máquinas virtuales en Hyper-V con salida a internet por una tarjeta de red interna con ...", "content": "Este post es un poco especial. Para llevarlo a cabo debéis tener un escenario parecido al siguiente.Escenario.Máquinas virtuales en Hyper-V con salida a internet por una tarjeta de red interna con NAT.Las ventajas que veo de este escenario son: Siempre sabemos que ip tiene la máquina virtual Salimos a internet Al usar conexiones internas es más seguro.Con dicho escenario, surge la necesidad de conectarnos con Escritorio Remoto a una de esas maquinas virtuales desde otro pc en la red o incluso desde fuera si usais VPN para conectaros a vuestro hogar.Con una imagen siempre es mejor.En la siguiente URL podeis ver como se hace: How to Create a NAT Switch on Hyper-V o incluso en la documentación oficial de Microsoft Como crear una red NATSolución.Bien, la solución es crear un túnel SSH y pivotar con el puerto del RDP usando SSH. Es estrictamente necesario que la maquina host tenga habilitado SSH Server para usarlo como máquina de salto.El siguiente comando seria una idea de lo que necesitamos:ssh -L 13389:IPMAQUINAVIRTUAL:3389 usuariohost@IPEQUIPOHOSTUna vez realizada la conexión, iniciamos mstsc.exe o tu gestor rdp preferido y nos conectamos a localhost:13389 y voila.Este tipo de tunel se puede configurar en Putty o MobaXterm sin mucha dificultad.PD: En este ejemplo he usado el puerto 13389 por su similitud con el estándar, pero en la práctica puede usarse cualquiera que esté libre.PD2: Probado este tipo de conexión con Termux y Remote Desktop en Android y funciona perfectamente." }, { "title": "Iniciar SSH Server en Windows con WSL2", "url": "/posts/SSH_to_WSL/", "categories": "Linux, WSL", "tags": "Linux, Windows, WSL", "date": "2022-09-02 08:10:00 +0200", "snippet": "Si alguna vez habéis tenido la necesidad de conectaros a vuestra maquina y mas concretamente a la versión de Linux instalada por WSL2, este es tu sitio 😉Instalación de OpenSSH ServerAntes de nada, ...", "content": "Si alguna vez habéis tenido la necesidad de conectaros a vuestra maquina y mas concretamente a la versión de Linux instalada por WSL2, este es tu sitio 😉Instalación de OpenSSH ServerAntes de nada, necesitamos tener OpenSSH, así que abrimos nuestra consola de PowerShell comoadministrador y ejecutamos estos comandos.Add-WindowsCapability -Online -Name OpenSSH.Client~~~~0.0.1.0Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0Habilitamos el servicio.Start-Service sshdSet-Service -Name sshd -StartupType 'Automatic'Con esto debería ser suficiente, en mi caso el firewall no me bloqueaba el servicio, pero conociendo a Windows… lo revisaba si tuvieras algún problema.Configurar WSL como Shell por defecto.En el siguiente paso vamos a configurar como Shell por defecto en Windows la consola de WSL.En una ventana de PowerShell como administrador pegamos el siguiente comando:New-ItemProperty -Path \"HKLM:\\SOFTWARE\\OpenSSH\" -Name DefaultShell -Value \"C:\\WINDOWS\\System32\\bash.exe\" -PropertyType String -ForceLlegados a este punto, la conexión debería funcionar. Tened en cuenta que si inicias sesión en Windows con la cuenta de Microsoft tendréis que ver como se llama el usuario que crea Windows para ese “usuario conectado”. Simplemente ir a la carpeta C:\\Users y lo veréis. La sintaxis sería algo así ssh (nombre-usuario)@(nombre o ip-equipo) ponemos clave de Windows y si todo ha salido bien, estaremos conectados por SSH a nuestro WSL2." } ]
