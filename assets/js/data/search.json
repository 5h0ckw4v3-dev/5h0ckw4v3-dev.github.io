[ { "title": "Nextcloud en Docker", "url": "/posts/nextcloud/", "categories": "Linux", "tags": "Linux, Shell, Terminal", "date": "2024-01-15 10:00:00 +0100", "snippet": "INTRODUCCI√ìNHoy vamos a ver la instalaci√≥n del aplicativo de Nextcloud usando Docker en una Raspberry Pi 4, tambien veremos la instalaci√≥n de Portainer para gestionar y configurar de una manera vis...", "content": "INTRODUCCI√ìNHoy vamos a ver la instalaci√≥n del aplicativo de Nextcloud usando Docker en una Raspberry Pi 4, tambien veremos la instalaci√≥n de Portainer para gestionar y configurar de una manera visual y desde el navegador nuestros diferentes contenedores y sus opciones. Procederemos a instalar los requisitos minimos.Instalaci√≥n de Portainer:Este paso no es necesario, pero despues de la experiencia que he tenido con el, me parece superinteresante y recomendable instalarlo.sudo docker pull portainer/portainer-ce:latestsudo docker run -d -p 9000:9000 --name=portainer --restart=always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer-ce:latestUna vez termina la instalaci√≥n y la miniconfiguraci√≥n que hemos aplicado en el segundo comando, nos dirijimos a http://[DIRECCI√ìN-IP]:9000Instalaci√≥n de Nextcloud:Realizamos la instalaci√≥n desde el mismo repositorio de Docker.docker pull nextclouddocker run -d -p 8080:80 --name nextcloud nextclouddocker logs nextcloudInstalaci√≥n de MariaDB:Probando la configuraci√≥n de Portainer, realic√© la instalaci√≥n desde el mismo en la secci√≥n App TemplatesDESARROLLOMuy importante, ambos contenedores deben estar en la misma red, lo mas recomendable es usar una conexi√≥n puente. O usamos la conexi√≥n por defecto como he hecho yo o creamos una nueva conexi√≥n puente y asi podemos crear distintas islas de conexiones con los diferentes servicios que a su vez interact√∫an entre si.Al iniciar Nextcloud nos indica que por defecto usa SQL Lite y no lo recomienda para el uso de clientes, es nuestro caso, asi que vamos a configurar la bbdd en el contenedor de MariaDB.Nos conectamos a nuestra raspberry y listamos los contenedores.Usamos Docker exec para conectarnos al contenedor deseado.Realizamos la conexi√≥n a MariaDB, la contrase√±a es la que configuramos cuando realizamos la instalaci√≥n desde Portainer.Creamos la BBDDCREATE DATABASE nextcloud;Creamos el usuarioCREATE USER ‚Äònextcloud‚Äô@‚Äô%‚Äô IDENTIFIED BY ‚Äòclavequequeramosponer;(Importante el usuario con %)Damos permisos al usuario en la BBDDGRANT ALL PRIVILEGES ON nextcloud.* TO nextcloud@‚Äô%‚Äô;Aplicamos los cambiosFLUSH PRIVILEGES;Nos dirijimos a la web de nuestro Nextcloud y rellenamos los datos.Le damos a Instalar y tardar√° unos minutos, pod√©is ir a tomar un caf√© perfectamente :DY cuando termina el proceso de instalaci√≥n, ya tenemos la nube lista.CONCLUSI√ìNPodriamos haber montado un stack para Nextcloud pero me ha parecido desaprovechar una instancia de BBDD que podria usar para algun que otro proyecto, por eso la he realizado en contenedores distintos." }, { "title": "Comandos Linux", "url": "/posts/comandos/", "categories": "Linux", "tags": "Linux, Shell, Terminal", "date": "2023-07-25 11:00:00 +0200", "snippet": "INTRODUCCI√ìNOs traigo una recopilaci√≥n de comandos Linux para diferentes usos, desde Redes a gesti√≥n de discos pasando por adminstraci√≥n de servicios. Espero que sea de utilidad, estar√© actualizand...", "content": "INTRODUCCI√ìNOs traigo una recopilaci√≥n de comandos Linux para diferentes usos, desde Redes a gesti√≥n de discos pasando por adminstraci√≥n de servicios. Espero que sea de utilidad, estar√© actualizando esta entrada.DESARROLLOOperaciones de Archivos: Comando Descripci√≥n ls Lista todos los archivos y directorios en el directorio de trabajo actual ls -R Lista los archivos en subdirectorios tambi√©n ls -a Muestra archivos ocultos ls -al Lista archivos y directorios con informaci√≥n detallada como permisos, tama√±o, propietario, etc cd nombredeldirectorio Cambia al directorio especificado cd .. Retrocede un nivel pwd Muestra el directorio de trabajo actual cat &gt; nombredelarchivo Crea un nuevo archivo cat archivo1 archivo2 &gt; archivo3 Une dos archivos (archivo1 y archivo2) y guarda el resultado en un nuevo archivo (archivo3) touch nombredelarchivo Crea o modifica un archivo rm nombredelarchivo Elimina un archivo cp origen destino Copia archivos desde la ruta de origen a la ruta de destino mv origen destino Mueve archivos desde la ruta de origen a la ruta de destino find / -name nombredelarchivo Encuentra un archivo o directorio por su nombre, comenzando desde la ra√≠z file nombredelarchivo Determina el tipo de archivo less nombredelarchivo Muestra el contenido del archivo p√°gina por p√°gina head nombredelarchivo Muestra las primeras diez l√≠neas de un archivo tail nombredelarchivo Muestra las √∫ltimas diez l√≠neas de un archivo lsof Muestra qu√© archivos est√°n abiertos por qu√© proceso du -h ‚Äìmax-depth=1 Muestra el tama√±o de cada directorio. Usa ‚Äìmax-depth=1 para limitar la salida al directorio actual y sus hijos inmediatos fdisk Comando de manipulaci√≥n de particiones de disco Operaciones con paquetes: Comando Descripci√≥n apt update (Debian) Actualiza la base de datos de los paquetes con los repositorios apt upgrade (Debian) Actualiza los paquetes usando la ultima versi√≥n de los repositorios apt autoremove (Debian) Elimina los paquetes obsoletos despues de un upgrade apt install ‚Äòpaquete‚Äô (Debian) Instala un paquete apt-cache ‚Äòpaquete‚Äô (Debian) Busca un paquete apt remove ‚Äòpaquete‚Äô (Debian) Desinstala un paquete dpkg -i ‚Äòpaquete descargado‚Äô (Debian) Instala un paquete descargado previamente dpkg ‚Äìconfigure -a (Debian) Configura los paquetes pendientes yum update (RedHat) Actualiza la base de datos de los paquetes con los repositorios yum upgrade (RedHat) Actualiza los paquetes usando la ultima versi√≥n de los repositorios yum install ‚Äòpaquete‚Äô (RedHat) Instala un paquete yum remove ‚Äòpaquete‚Äô (RedHat) Desinstala un paquete rpm -qa Lista los paquetes instalados en el sistema, recomendable usar con ‚Äògrep‚Äô package-cleanup ‚Äìoldkernels ‚Äìcount=2 (RedHat) Elimina los kernels antiguos manteniendo los dos mas actuales Operaciones de Procesos: Comando Descripci√≥n ps Muestra los procesos activos en el momento top Muestra todos los procesos en ejecuci√≥n kill pid Finaliza el proceso con el PID (identificador del proceso) dado pkill nombre Finaliza el proceso con el nombre especificado bg Reactiva trabajos suspendidos sin llevarlos al primer plano fg Lleva el trabajo m√°s reciente al primer plano fg n Lleva el trabajo n al primer plano renice +n [pid] Cambia la prioridad de un proceso en ejecuci√≥n &amp;&gt;nombredelarchivo Redirige tanto la salida est√°ndar como la de error al archivo especificado 1&gt; nombredelarchivo Redirige la salida est√°ndar al archivo especificado 2&gt; nombredelarchivo Redirige la salida de error al archivo especificado Permisos de Archivos: Comando Descripci√≥n chmod octal nombredelarchivo Cambia los permisos del archivo a octal, que puede estar entre 0 (sin permisos) y 7 (permisos completos) chown nombredepropietario nombredelarchivo Cambia el propietario del archivo chown nombredepropietario:nombredelgrupo nombredelarchivo Cambia el propietario y el grupo del archivo chgrp nombredelgrupo nombredelarchivo Cambia el grupo propietario del archivo Redes: Comando Descripci√≥n ping host Realiza un ping a un host y muestra los resultados whois dominio Obtiene informaci√≥n whois para un dominio dig dominio Obtiene informaci√≥n DNS para un dominio netstat -pnltu Muestra informaci√≥n relacionada con la red, como conexiones de red, tablas de enrutamiento, estad√≠sticas de interfaz, etc ifconfig Muestra las direcciones IP de todas las interfaces de red ssh usuario@host Inicio de sesi√≥n remoto en el host como usuario scp Transfiere archivos entre hosts a trav√©s de ssh wget url Descarga archivos desde la web curl url Env√≠a una solicitud a una URL y devuelve la respuesta traceroute dominio mtr combina la funcionalidad de los programas traceroute y ping en una sola herramienta de diagn√≥stico de red mtr dominio Cambia el propietario y el grupo del archivo ss Otra utilidad para investigar sockets. Es una alternativa m√°s moderna a netstat nmap Herramienta de exploraci√≥n de redes y escaneo de seguridad Compresi√≥n y Archivos: Comando Descripci√≥n tar cf archivo.tar archivos Crea un archivo tar llamado archivo.tar que contiene los archivos especificados tar xf archivo.tar Extrae los archivos de archivo.tar gzip archivo Comprime el archivo y lo renombra a archivo.gz gzip -d archivo.gz Descomprime archivo.gz y lo restaura al archivo original zip -r archivo.zip archivos Crea un archivo zip llamado archivo.zip que contiene los archivos especificados unzip archivo.zip Extrae el contenido de un archivo zip tar -cvf archiv.tar directorio/ Crea un archivo tar tar -xvf archiv.tar Extrae un archivo tar tar -jcvf archiv.tar.bz2 directorio/ Crea un archivo bz2 comprimido tar -jxvf archiv.tar.bz2 Extrae un archivo bz2 comprimido Procesamiento de Texto: Comando Descripci√≥n grep patr√≥n archivos Busca un patr√≥n en los archivos grep -r patr√≥n directorio Busca de forma recursiva un patr√≥n en un directorio comando | grep patr√≥n Envia la salida del comando a grep para buscar echo ‚Äòtexto‚Äô Imprime texto sed ‚Äòs/cadena1/cadena2/g‚Äô nombredelarchivo Reemplaza cadena1 con cadena2 en el archivo diff archivo1 archivo2 Compara dos archivos y muestra las diferencias wc nombredelarchivo Cuenta l√≠neas, palabras y caracteres en un archivo awk Un lenguaje de programaci√≥n vers√°til para trabajar con archivos Uso del Disco: Comando Descripci√≥n df Muestra el uso del disco du Muestra el uso del espacio en directorios free Muestra el uso de memoria y swap whereis aplicaci√≥n Muestra las posibles ubicaciones de una aplicaci√≥n dd if=/dev/zero of=/tmp/salida.img bs=8k count=256k Crea un archivo de un tama√±o determinado para probar la velocidad del disco. No usar con Veritas hdparm -Tt Mide la velocidad de lectura de tu disco duro Veritas: Comando Descripci√≥n hastatus -sum Ver estado de cluster hagrp -online nombrecluster -sys nombreservidor Levantar cluster en servidor indicado hagrp -ofline nombrecluster -sys nombreservidor Desactivar cluster en servidor indicado hagrp -switch nombrecluster -to nombreservidor2 Cambiar cluster de nodo hares -state nombreaplicacioncluster Comprueba el estado de la aplicaci√≥n Informaci√≥n del Sistema: Comando Descripci√≥n date Muestra la fecha y hora actual cal Muestra el calendario del mes actual uptime Muestra el tiempo de actividad actual w Muestra qui√©n est√° en l√≠nea whoami Muestra el nombre del usuario actual uname -a Muestra informaci√≥n del kernel df -h Uso del disco en formato legible para humanos du -sh Uso del disco del directorio actual en formato legible para humanos free -m Muestra la memoria libre y utilizada en MB SELinux: Comando Descripci√≥n ausearch -m AVC,USER_AC,SELINUX_ERR,USER_SELINUX_ERR -ts recent Muestra las rutas bloqueadas por SELinux matchpathcon -V rutadelarchivodelog Muestra las etiquetas actuales y las que debe tener chcon -Rv ‚Äìtype=nombreetiqueta rutadelarchivo Realiza un reetiquetado temporal semanage fcontext -a -t nombreetiqueta ‚Äúrutadelarchivo‚Äù Realiza un reetiquetado permanente a√±adiendo una etiqueta semanage fcontext -m -t nombreetiqueta ‚Äúrutadelarchivo‚Äù Realiza un reetiquetado permanente modificando una etiqueta rescorecon -v rutadelarchivo Ejecuta los cambios realizados por chcon o semanage ls -Z Muestra las etiquetas de una carpeta o archivo Otros (principalmente utilizados en scripts): Comando Descripci√≥n comando1 ; comando2 Ejecuta comando1 y luego comando2 comando1 &amp;&amp; comando2 Ejecuta comando2 solo si comando1 es exitoso comando1 || comando2 Ejecuta comando2 solo si comando1 no es exitoso comando &amp; Ejecuta el comando en segundo plano Variables de Entorno: Comando Descripci√≥n env Muestra todas las variables de entorno echo $VARIABLE Muestra el valor de una variable de entorno export VARIABLE=valor Establece el valor de una variable de entorno alias nuevo_comando=‚Äôviejo_comando opciones‚Äô Ejecuta el comando en segundo plano echo $PATH Imprime la variable de entorno PATH export PATH=$PATH:/nueva/ruta Agrega /nueva/ruta a la variable de entorno PATH Programaci√≥n de Tareas (Cron Jobs): Comando Descripci√≥n crontab -l Lista todas tus tareas cron crontab -e Edita tus tareas cron crontab -r Elimina todas tus tareas cron crontab -v Muestra la √∫ltima vez que editaste tus tareas cron crontab archivo Instala una tarea cron desde un archivo @reboot comando Programa una tarea para que se ejecute al inicio Scripting de Shell: Comando Descripci√≥n #!/bin/bash L√≠nea shebang para especificar el int√©rprete de scripts $0, $1, ‚Ä¶, $9, ${10}, ${11} Argumentos del script if [condici√≥n]; then ‚Ä¶ fi Estructura de la declaraci√≥n if en scripts de bash for i in {1..10}; do ‚Ä¶ done Bucle for en scripts de bash while [condici√≥n]; do ‚Ä¶ done Bucle while en scripts de bash funci√≥n nombre() {‚Ä¶} Define una funci√≥n Monitoreo y Rendimiento del Sistema: Comando Descripci√≥n iostat Informa estad√≠sticas de la Unidad Central de Procesamiento (CPU) y estad√≠sticas de entrada/salida para dispositivos, particiones y sistemas de archivos de red vmstat Argumentos del script htop Estructura de la declaraci√≥n if en scripts de bash B√∫squeda y Encontrar: Comando Descripci√≥n locate nombredelarchivo Encuentra un archivo por su nombre. La base de datos se actualiza con el comando updatedb whereis nombredeprograma Localiza los archivos binarios, de origen y de p√°gina de manual para un comando which nombredelcomando Muestra la ruta completa de los comandos (shell) Otros: Comando Descripci√≥n yes &gt; /dev/null &amp; Usa este comando para llevar un sistema al l√≠mite ‚Äù:(){ :|:&amp; };::‚Äù Una bomba: √∫sala con cuidado. No ejecutes este comando en un sistema de producci√≥n RECOMENDACI√ìNRecuerda que siempre puedes usar el comando man (por ejemplo, man ls) para obtener m√°s informaci√≥n sobre cada comando." }, { "title": "NfTables", "url": "/posts/nftables/", "categories": "Linux", "tags": "Linux, Aplicaciones, Firewall", "date": "2023-04-28 11:00:00 +0200", "snippet": "INTRODUCCI√ìNHoy vamos a hablar un poquito de nftables, tambien llamado el sucesor de iptables. RHEL 8 aconseja su uso para entornos complejos y cr√≠ticos.Documentaci√≥n oficial RHEL8Nftables se basa ...", "content": "INTRODUCCI√ìNHoy vamos a hablar un poquito de nftables, tambien llamado el sucesor de iptables. RHEL 8 aconseja su uso para entornos complejos y cr√≠ticos.Documentaci√≥n oficial RHEL8Nftables se basa en tablas üòâ y tiene un archivo de configuraci√≥n que podriamos llamarlo la piedra angular del servicio ubicado en /etc/sysconfig y llamado nftables.confComo bien indica la documentaci√≥n, se aconseja el uso para entornos complejos asi que debemos gestionar las tablas de manera individual, usando el archivo mencionado antes para solamente guardar la configuraci√≥n.DESARROLLOPara comenzar a usar nftables tenemos que crear la estructura de las tablas en cuestion.Vamos a crear una tabla llamada mitablanft add table inet mitablaSeguidamente vamos a crear las 3 cadenas (Input, Output y Forward)nft add chain inet mitabla input '{type filter hook input priority filter;}'nft add chain inet mitabla output '{type filter hook output priority filter;}'nft add chain inet mitabla forward '{type filter hook forward priority filter;}'Esto es la estructura base, ahora es momento de ir a√±adiendo las diferentes reglas.Un ejemplo de Inputnft add rule inet mitabla input ip saddr \"ip_remota\" ip daddr \"ip_local\" tcp/udp dport \"puerto\" acceptUn ejemplo de Outputnft add rule inet mitabla output ip saddr \"ip_local\" ip daddr \"ip_remota\" tcp/udp dport \"puerto\" acceptUn detalle a tener en cuenta, es que podemos a√±adir reglas con el nombre del equipo en vez de usar la ip, pero nftables al final cambiar√° esa linea y usar√° la ip.Una vez tengamos a√±adidas todas las reglas de la tabla MITABLA procedemos primero a guardar esa tabla en un archivo y luego a actualizar el archivo de configuracion.nft list table inet mitabla &gt; /etc/nftables/nftables.d/00-mitablanft list ruleset &gt; /etc/sysconfig/nftables.confRECOMENDACI√ìNSi en un futuro necesitamos editar o a√±adir alg√∫n par√°metro en esta tabla, el procedimiento seria el siguiente: Editamos el archivo vi /etc/nftables/nftables.d/00-mitabla Vaciamos la tabla MITABLA nft flush table inet mitabla Importamos la nueva nft -f /etc/nftables/nftables.d/00-mitabla Guardamos en el archivo de configuraci√≥n nft list ruleset &gt; /etc/sysconfig/nftables.conf Para comprobar que los datos estan correctos, reiniciamos el servicio systemctl restart nftables y comprobamos que los cambios est√°n persistentes nft list table inet mitabla De esta manera, tenemos organizadas las reglas por tablas en la carpeta del ejemplo /etc/nftables/nftables.d y podemos ir importando lo que vayamos necesitando. Espero que haya sido de utilidad. üòâ" }, { "title": "Phanthom process killer en Termux", "url": "/posts/termux/", "categories": "Linux, Android", "tags": "Linux, Aplicaciones, Pentesting", "date": "2023-03-08 10:00:00 +0100", "snippet": "Hoy vamos a ver una entrada sobre Android. Concretamente un problema de gesti√≥n de procesos en Android 12/13.INTRODUCCI√ìNSoy usuario de Termux en mi m√≥vil y Tablet y adem√°s uso NetHunter Rootless, ...", "content": "Hoy vamos a ver una entrada sobre Android. Concretamente un problema de gesti√≥n de procesos en Android 12/13.INTRODUCCI√ìNSoy usuario de Termux en mi m√≥vil y Tablet y adem√°s uso NetHunter Rootless, bueno pues desde que est√° con nosotros Android 12 tenemos un inconveniente llamado ‚ÄúPhantom Process Killer‚Äù. B√°sicamente el sistema operativo matar√° cualquier proceso mayor de 32 (es el limite de todas las aplicaciones combinadas).Debido a esto, cuando iniciamos KEX para obtener una interface gr√°fica de NetHunter obtenemos a los pocos segundos (el tiempo que tarda el sistema en matar los procesos) el siguiente error en Termux.Process completed (signal 9) ‚Äì press EnterSOLUCI√ìNNecesitamos: Habilitar las Opciones del desarrollador en el terminal y habilitar dentro la Depuraci√≥n por USB. Descargar ADB en un pc.Una vez conectemos el terminal por usb, aceptamos el mensaje y escribimosadb devicesPara comprobar que nos reconoce el terminal.A continuaci√≥n, vamos a ejecutar los siguientes comandos en orden.adb shell \"/system/bin/device_config set_sync_disabled_for_tests persistent‚Äùadb shell \"/system/bin/device_config put activity_manager max_phantom_processes 2147483647‚Äùadb shell settings put global settings_enable_monitor_phantom_procs falseCOMPROBACI√ìNPara comprobar que todo esta correcto, ejecutamos los siguientes comandos:adb shell \"/system/bin/dumpsys activity settings | grep max_phantom_processes‚ÄùNos devolver√° ‚Äúmax_phantom_processes=2147483647‚Äùadb shell \"/system/bin/device_config get activity_manager max_phantom_processes‚ÄùNos devolver√° 2147483647Ya podemos disfrutar de KEX sin problemas. üòâ" }, { "title": "Analizando un dominio", "url": "/posts/dominio/", "categories": "Linux", "tags": "Linux, Aplicaciones, Pentesting", "date": "2023-01-30 10:00:00 +0100", "snippet": "Hoy vamos a analizar la informaci√≥n que nos da un dominio de internet, usaremos las aplicaciones host, dig y whois.HOSTLa sint√°xis de host es:host (modificadores) dominio\"Realizamos una prueba con ...", "content": "Hoy vamos a analizar la informaci√≥n que nos da un dominio de internet, usaremos las aplicaciones host, dig y whois.HOSTLa sint√°xis de host es:host (modificadores) dominio\"Realizamos una prueba con una web, por ejemplo ‚Äúmarca.com‚ÄùAdem√°s, podemos realizar DNS inverso üòâA continuaci√≥n os dejo el enlace a toda su informaci√≥n.Host manualDIGLa sint√°xis de dig es un poco m√°s compleja en la teoria:dig (modificadores)@servidor.dns dominio tipo_de_registo Al usar el mismo comando vemos que nos da algunos datos m√°s que host.Dig es bastante extenso, os dejo acceso a toda su informaci√≥n para quien quiera seguir probando cosas.Dig manualWHOISWhois es uno de las aplicaciones por excelencia para averiguar informacion sobre un dominio, su sint√°xis es sencilla:whois dominioEn la siguiente captura podemos ver una parte de lo que ha conseguido.A continuaci√≥n os dejo el enlace a toda su informaci√≥n.Whois manualEspero que haya sido de vuestro agrado. üòâ" }, { "title": "Crear red personalizada en Hyper-V", "url": "/posts/nat_hyperv/", "categories": "Windows", "tags": "Powershell, Hyper-V", "date": "2023-01-01 10:00:00 +0100", "snippet": "Comenzamos el a√±o con una entrada, la cual en mi experiencia, es muy importante. Desde hace unos a√±os uso Hyper-V como gestor de m√°quinas virtuales en Windows y uno de los problemas que tenian vers...", "content": "Comenzamos el a√±o con una entrada, la cual en mi experiencia, es muy importante. Desde hace unos a√±os uso Hyper-V como gestor de m√°quinas virtuales en Windows y uno de los problemas que tenian versiones anteriores era la gestion de la red. Con este peque√±o truco no volveremos a tener problemas en la conexi√≥n a internet de nuesta virtual aunque el host cambie de cable a wifi (muy com√∫n en Hyper-V que ocurra esto).RequisitosTenemos que identificar un rango de IPs que no vaya a tener problemas con otras redes. Por ejemplo 192.168.200.0/24.Abrimos Powershell como administrador.ProcedimientoCrearemos un switch interno llamado MiSwitchInterno.New-VMSwitch -SwitchName \"MiSwitchInterno\" -SwitchType InternalVamos a listar los adaptadores y debemos apuntar la numeraci√≥n del ifIndex de nuestro switch.Get-NetAdapterUna vez identificado, procedemos a configurar una IP fija en el switch (por ejemplo 74).New-NetIPAddress -IPAddress 192.168.200.2 -PrefixLength 24 -InterfaceIndex 74Por √∫ltimo creamos la NAT para darle salida a internet a nuestro switch.New-NetNat -Name MiNatSwitch -InternalIPInterfaceAddressPrefix 192.168.200.0/24De esta manera, podemos crear una subred donde al asignar IPs fijas a las m√°quinas virtuales ya no tendremos problemas de conectividad.Por ejemplo, con los datos suministrados, al asignar este switch interno no obtendria internet, debemos asignarle una IP fija dentro del rango 192.168.200.0/24 y obligatoriamente poner de puerta de enlace 192.168.200.2. De DNS puede ponerse los de Google o Cloudflare.Al usar todas el mismo rango, podemos incluso crear clusters o realizar pruebas entre ellas sin problema.El mundo de las redes es muy bonito pero a la vez complejo, espero haberme explicado correctamente üòâOtros comandos de inter√©s pueden ser:Ver los NATsGet-NetNatEliminar un NATRemove-NetNat -Name MiNatSwitch" }, { "title": "Instalaci√≥n y configuraci√≥n de Bitbucket Server en Ubuntu", "url": "/posts/bitbucket/", "categories": "Linux", "tags": "Linux, Aplicaciones", "date": "2022-12-10 10:00:00 +0100", "snippet": "Tal y como vimos en el post anterior con la instalaci√≥n de Subversion, hoy vamos a ver como instalar Bitbucket server en nuestro servidor Ubuntu. Para extrapolarlo a otro linux tenemos que tener en...", "content": "Tal y como vimos en el post anterior con la instalaci√≥n de Subversion, hoy vamos a ver como instalar Bitbucket server en nuestro servidor Ubuntu. Para extrapolarlo a otro linux tenemos que tener en cuenta las dependencias ya que en RHEL o CentOS las versiones de Git en los repositorios son antiguas y hay que instalarlo compilando desde la fuente.Descarga.Podemos hacer la descarga de tres maneras distintas. Ejecutable .bin y los comprimidos tar.gz y zip. En este caso vamos a hacerlo con .bin. Lo descargamos de la siguiente URL https://www.atlassian.com/es/software/bitbucket/download-archivesRequisitos.Si hacemos la instalacion con el .bin solamente necesitamos una version actualizada de Git. En Ubuntu no hay problema asi que instalamos normalmente.sudo apt install gitEn RHEL y derivados tenemos que instalar Git desde la fuente ya que los repositorios no tienen una versi√≥n actualizada del mismo.B√°sicamente la instalaci√≥n seria algo asi:sudo yum -y remove git*sudo yum -y install epel-releasesudo yum -y groupinstall \"Development Tools\"sudo yum -y install wget perl-CPAN gettext-devel perl-devel openssl-devel zlib-devel curl-devel expat-devel getopt asciidoc xmlto docbook2X curl zlib-develsudo ln -s /usr/bin/db2x_docbook2texi /usr/bin/docbook2x-texi\t-- -- -- export VER=\"v2.38.1\"wget https://github.com/git/git/archive/${VER}.tar.gztar -xvf ${VER}.tar.gzrm -f ${VER}.tar.gzcd git-*make configuresudo ./configure --prefix=/usrsudo makesudo make installY la desinstalaci√≥n en caso de necesitarlo üòâ:./configuresudo make &amp;&amp; sudo make DESTDIR=/var/tmp/git installsudo find /var/tmp/git -type f -printf '/%P\\n' | sudo xargs -n 10 rm -fInstalaci√≥n.Damos permisos de ejecuci√≥n y ejecutamos el archivo.chmod +x atlassian-bitbucket-8.6.1-x64.bin./atlassian-bitbucket-8.6.1-x64.binEn las siguientes im√°genes podemos ver las preguntas que va realizando y la respuesta.Una vez termine el proceso accedemos a la url.http://IP_Servidor:7990/setupY veremos lo siguienteSeguidamente necesitaremos la licencia de instalaci√≥n. Para un server podemos solicitar una evaluaci√≥n de 90 dias simplemente registrandonos en la web. Una vez hecho veremos algo as√≠.Una vez tenemos la licencia solo nos queda crear el usuario.Iniciamos sesi√≥n y ya estamos dentro.A disfrutarlo! ;)" }, { "title": "Instalaci√≥n y configuraci√≥n de SVN en CentOS", "url": "/posts/svn/", "categories": "Linux", "tags": "Linux, Aplicaciones", "date": "2022-11-27 09:30:00 +0100", "snippet": "El t√©rmino SVN se refiere a un software de control de versiones y existe desde hace mucho tiempo y aunque aplicaciones del tipo git (como el Github donde estas leyendo esto) o Bitbucket puedan ser ...", "content": "El t√©rmino SVN se refiere a un software de control de versiones y existe desde hace mucho tiempo y aunque aplicaciones del tipo git (como el Github donde estas leyendo esto) o Bitbucket puedan ser la evoluci√≥n natural, lo cierto es que SVN se sigue usando.Vamos a realizar una instalaci√≥n b√°sica en CentOS 7.Instalaci√≥n.Realizamos la instalaci√≥n de todos los paquetes necesarios y editamos la configuraci√≥n de Apache.sudo yum install httpd subversion libapache2-svn libsvn-dev mod_dav_svn\t -----vim /etc/httpd/conf/httpd.conf -- Editar y habilitar el puerto 80Seguidamente habilitaremos los modulos necesarios en Apache.vim /etc/httpd/conf.d/subversion.conf -----# Make sure you uncomment the following if they are commented outLoadModule dav_svn_module modules/mod_dav_svn.soLoadModule authz_svn_module modules/mod_authz_svn.so# Add the following to allow a basic authentication and point Apache to where# the actual# repository resides.&lt;Location /repos&gt; DAV svn SVNPath /var/www/svn/repos AuthType Basic AuthName \"Subversion repos\" AuthUserFile /etc/svn-auth-conf Require valid-user&lt;/Location&gt;Y reiniciamos el servicio de Apache como de costumbre para aplicar los cambios.service httpd startConfiguraci√≥n.Crearemos el directorio dedicado a subversi√≥n y otorgaremos los permisos necesarios.mkdir /var/www/svnchmod -R 755 /var/www/svnY ahora vamos a crear nuestro primer repositorio de pruebas.svnadmin create /var/www/svn/reposchown -R apache.apache /var/www/svn/reposVamos ha crear un usuario para que pueda acceder al repositorio.sudo htpasswd -cm /etc/svn-auth-conf usuarioReiniciamos el servicio de apache y accedemos a la url de nuestro repositorio para probarlo. Nos pedir√° introducir las credenciales.http://localhost/reposSer√≠a v√°lido tanto localhost como la ip del equipo, comprobar firewalld si da alg√∫n problema." }, { "title": "Instalaci√≥n y uso de Win-Kex en Ubuntu", "url": "/posts/kex/", "categories": "Linux", "tags": "Linux, Aplicaciones, Pentesting", "date": "2022-11-01 09:30:00 +0100", "snippet": "Hoy os traigo una de las aplicaciones estrella de Kali Linux de WSL. No es otra que Kali-Win-Kex, el entorno gr√°fico nativo.La web del proyecto es la siguiente: Proyecto Kali-Win-KexInstalaci√≥n.Com...", "content": "Hoy os traigo una de las aplicaciones estrella de Kali Linux de WSL. No es otra que Kali-Win-Kex, el entorno gr√°fico nativo.La web del proyecto es la siguiente: Proyecto Kali-Win-KexInstalaci√≥n.Como con cualquier archivo .deb debemos descargarlo. La √∫ltima versi√≥n estable podemos obtenerla desde aqu√≠.Elegimos el archivo de nuestra arquitectura y lo descargamos.wget https://http.kali.org/pool/main/k/kali-win-kex/kali-win-kex_3.1_amd64.debInstalamossudo dpkg -i kali-win-kex_3.1_amd64.debSi nos da error, ejecutamos lo siguiente, ya que es un paquete que necesita algunas (bastantes) dependencias que por defecto, el WSL de Ubuntu no trae instaladas.sudo apt -f installAhora vamos a instalar el entorno gr√°fico. Kali Linux por defecto viene con XFCE4 en WSL. Pues vamos a instalar el mismo o parecido (xubuntu-desktop tambien valdr√≠a) y as√≠ aseguramos el √©xito.sudo apt install xfce4Ejecuci√≥n.Una vez instaladas todas las dependencias y sin m√°s errores, ejecutamos la aplicaci√≥n.kexSeguimos los pasos normales de TightVNC y escribimos las Password que nos solicita.Y si todo va bien deberia de iniciar el escritorio XFCE4. üòâVereis algo parecido a la imagen de este post." }, { "title": "WPScan, software para analizar vulnerabilidades en Wordpress", "url": "/posts/wpscan/", "categories": "Linux", "tags": "Linux, Aplicaciones, Pentesting", "date": "2022-10-26 10:20:00 +0200", "snippet": "Siguiendo en la linea de la recomendaci√≥n de aplicaciones interesantes, le ha llegado el turno a WPScan.Estamos hablando de un software gratuito que ayuda a identificar los problemas relacionados c...", "content": "Siguiendo en la linea de la recomendaci√≥n de aplicaciones interesantes, le ha llegado el turno a WPScan.Estamos hablando de un software gratuito que ayuda a identificar los problemas relacionados con la seguridad en un sitio con Wordpress.Verifica entre otros: La propia instalaci√≥n de Wordpress. Vulnerabilidades en Themes y Plugins. Brute Force.Teniendo en cuenta que Wordpress es el CMS mas popular con diferencia, conocer esta utilidad es un plus.Instalaci√≥n.Para instalarlo, necesita unos prerequisitos que los conseguiremos con el siguiente comando.sudo apt install curl git libcurl4-openssl-dev make zlib1g-dev gawk g++ gcc libreadline6-dev libssl-dev libyaml-dev libsqlite3-dev sqlite3 autoconf libgdbm-dev libncurses5-dev automake libtool bison pkg-config ruby ruby-bundler ruby-dev -ySeguidamente instalamos usando GEM.sudo gem install wpscanEjecuci√≥n.Primero actualizamos la base de datos y luego escanemos el sitio web deseado.wpscan --updatewpscan --url https://web.comOs dejo la web del proyecto en Github para que todos podamos estar pendientes de las novedades. üòâProyecto WPScan" }, { "title": "Btop, un completo monitor de sistema para Linux", "url": "/posts/btop/", "categories": "Linux", "tags": "Linux, Aplicaciones", "date": "2022-09-30 10:00:00 +0200", "snippet": "Este post va a estrenar una nueva secci√≥n. Aplicaciones recomendadas. üòÅInstalaci√≥n.Para instalarlo, solamente tenemos que ejecutar lo siguiente.sudo apt install btopEjecuci√≥n.Simplemente as√≠.btopEn...", "content": "Este post va a estrenar una nueva secci√≥n. Aplicaciones recomendadas. üòÅInstalaci√≥n.Para instalarlo, solamente tenemos que ejecutar lo siguiente.sudo apt install btopEjecuci√≥n.Simplemente as√≠.btopEn mi Ubuntu uso Tilix como emulador de terminal, pero hay algunos reportes de que no funciona correctamente en algunos terminales." }, { "title": "Acceso a MV con red interna habilitada", "url": "/posts/Tunel_RDP/", "categories": "Windows", "tags": "Linux, Windows, Hyper-V", "date": "2022-09-12 08:10:00 +0200", "snippet": "Este post es un poco especial. Para llevarlo a cabo deb√©is tener un escenario parecido al siguiente.Escenario.M√°quinas virtuales en Hyper-V con salida a internet por una tarjeta de red interna con ...", "content": "Este post es un poco especial. Para llevarlo a cabo deb√©is tener un escenario parecido al siguiente.Escenario.M√°quinas virtuales en Hyper-V con salida a internet por una tarjeta de red interna con NAT.Las ventajas que veo de este escenario son: Siempre sabemos que ip tiene la m√°quina virtual Salimos a internet Al usar conexiones internas es m√°s seguro.Con dicho escenario, surge la necesidad de conectarnos con Escritorio Remoto a una de esas maquinas virtuales desde otro pc en la red o incluso desde fuera si usais VPN para conectaros a vuestro hogar.Con una imagen siempre es mejor.En la siguiente URL podeis ver como se hace: How to Create a NAT Switch on Hyper-V o incluso en la documentaci√≥n oficial de Microsoft Como crear una red NATSoluci√≥n.Bien, la soluci√≥n es crear un t√∫nel SSH y pivotar con el puerto del RDP usando SSH. Es estrictamente necesario que la maquina host tenga habilitado SSH Server para usarlo como m√°quina de salto.El siguiente comando seria una idea de lo que necesitamos:ssh -L 13389:IPMAQUINAVIRTUAL:3389 usuariohost@IPEQUIPOHOSTUna vez realizada la conexi√≥n, iniciamos mstsc.exe o tu gestor rdp preferido y nos conectamos a localhost:13389 y voila.Este tipo de tunel se puede configurar en Putty o MobaXterm sin mucha dificultad.PD: En este ejemplo he usado el puerto 13389 por su similitud con el est√°ndar, pero en la pr√°ctica puede usarse cualquiera que est√© libre.PD2: Probado este tipo de conexi√≥n con Termux y Remote Desktop en Android y funciona perfectamente." }, { "title": "Iniciar SSH Server en Windows con WSL2", "url": "/posts/SSH_to_WSL/", "categories": "Linux, WSL", "tags": "Linux, Windows, WSL", "date": "2022-09-02 08:10:00 +0200", "snippet": "Si alguna vez hab√©is tenido la necesidad de conectaros a vuestra maquina y mas concretamente a la versi√≥n de Linux instalada por WSL2, este es tu sitio üòâInstalaci√≥n de OpenSSH ServerAntes de nada, ...", "content": "Si alguna vez hab√©is tenido la necesidad de conectaros a vuestra maquina y mas concretamente a la versi√≥n de Linux instalada por WSL2, este es tu sitio üòâInstalaci√≥n de OpenSSH ServerAntes de nada, necesitamos tener OpenSSH, as√≠ que abrimos nuestra consola de PowerShell comoadministrador y ejecutamos estos comandos.Add-WindowsCapability -Online -Name OpenSSH.Client~~~~0.0.1.0Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0Habilitamos el servicio.Start-Service sshdSet-Service -Name sshd -StartupType 'Automatic'Con esto deber√≠a ser suficiente, en mi caso el firewall no me bloqueaba el servicio, pero conociendo a Windows‚Ä¶ lo revisaba si tuvieras alg√∫n problema.Configurar WSL como Shell por defecto.En el siguiente paso vamos a configurar como Shell por defecto en Windows la consola de WSL.En una ventana de PowerShell como administrador pegamos el siguiente comando:New-ItemProperty -Path \"HKLM:\\SOFTWARE\\OpenSSH\" -Name DefaultShell -Value \"C:\\WINDOWS\\System32\\bash.exe\" -PropertyType String -ForceLlegados a este punto, la conexi√≥n deber√≠a funcionar. Tened en cuenta que si inicias sesi√≥n en Windows con la cuenta de Microsoft tendr√©is que ver como se llama el usuario que crea Windows para ese ‚Äúusuario conectado‚Äù. Simplemente ir a la carpeta C:\\Users y lo ver√©is. La sintaxis ser√≠a algo as√≠ ssh (nombre-usuario)@(nombre o ip-equipo) ponemos clave de Windows y si todo ha salido bien, estaremos conectados por SSH a nuestro WSL2." } ]
